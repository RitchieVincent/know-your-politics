$(function(){$.fx.speeds.slow=800,$.fx.speeds.xslow=1200;var t,a,e="1",o=0,i=Object.keys(text.questions).length,c=0,n=0,r=0,s=0,l=0,u=0,d=0,p=0,h=0,m=0,v=0,f="labourChoice conservativeChoice libdemChoice ukipChoice",C=document.getElementById("correctAudio"),y=document.getElementById("incorrectAudio"),g=document.getElementById("timeUpAudio"),S=document.getElementById("resultAudio");$(".headerDownBtn").click(function(){$("html,body").animate({scrollTop:$(".wellLabour").offset().top-50},"slow")});var b=function(o,i,t,a){$("#selectedSection").addClass(""+i),$(".selectedPartyTitle").append("<h1>"+o+"</h1>"),$("#"+t).fadeIn("slow"),e="2",$(".partyBtn").prop("disabled",!0),$("#questionSection").slideToggle("slow"),$("#questionSection").addClass(""+a)};$(".partyBtn").click(function(w){function q(){if(1>o){var e=setTimeout(function(){$("#questionSection").removeClass(f),x(),T(),$(".correctParty").html(""),$(".correctParty").fadeTo(200,0)},4e3);e()}else $(".choiceBtn").prop("disabled",!0),$("#questionSection").slideUp(3e3,function(){A()})}function T(){$(".loadingBar").addClass("loadingBarAnimate"),$(".loadingBar").one($.support.transition.end,function(){$(".loadingBar").removeClass("loadingBarAnimate"),$(".choiceBtn").prop("disabled",!0),L("timeUp",""),q()})}function x(){t=Math.floor(Math.random()*i+0),document.getElementById("theQuestions").innerHTML="<h3>"+text.questions[t].question+"</h3><p>Do you agree with this policy?</p>",a=text.questions[t].party,o++,"labourChoice"==text.questions[t].party&&c++,"conservativeChoice"==text.questions[t].party&&r++,"libdemChoice"==text.questions[t].party&&l++,"ukipChoice"==text.questions[t].party&&d++,$(".choiceBtn").prop("disabled",!1)}function Q(){isNaN(m)&&(m=0)}function k(e,o,i,t){var a=google.visualization.arrayToDataTable([["Party","Amount agreed with"],["Labour",e],["UKIP",o],["Liberal democrat",i],["Conservative",t]]),c={pieHole:.5,pieSliceTextStyle:{color:"black"},colors:["#e74c3c","#9b59b6","#F7E041","#3498db"],backgroundColor:"#009688",pieSliceBorderColor:"#009688",legend:"none",chartArea:{top:0,height:300},height:300},n=new google.visualization.PieChart(document.getElementById("resultsChart"));n.draw(a,c)}function I(e,o){$(".scoreNumber").html("<p>You got "+e+"% of the "+B+" questions correct.</p>"),$(".scoreNumber").append("<p>Your overall score is: "+o+"</p>"),k(n,p,u,s)}function A(){S.play(),$("#resultSection").slideDown("xslow",function(){window.scrollTo(0,document.body.scrollHeight)}),"labourChoice"==P&&(m=h/c*100,m=m.toFixed(),Q(c),I(m,v)),"conservativeChoice"==P&&(m=h/r*100,m=m.toFixed(),Q(r),I(m,v)),"libdemChoice"==P&&(m=h/l*100,m=m.toFixed(),Q(l),I(m,v)),"ukipChoice"==P&&(m=h/d*100,m=m.toFixed(),Q(d),I(m,v))}function L(e){"labourChoice"==e&&($("#questionSection").removeClass(f),$("#questionSection").addClass("labourChoice"),$(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>Actually, this is a Labour policy!</p>"),y.play()),"conservativeChoice"==e&&($("#questionSection").removeClass(f),$("#questionSection").addClass("conservativeChoice"),$(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>Actually, this is a Conservative policy!</p>"),y.play()),"libdemChoice"==e&&($("#questionSection").removeClass(f),$("#questionSection").addClass("libdemChoice"),$(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>Actually, this is a Liberal Democrat policy!</p>"),y.play()),"ukipChoice"==e&&($("#questionSection").removeClass(f),$("#questionSection").addClass("ukipChoice"),$(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>Actually, this is a UKIP policy!</p>"),y.play()),"timeUp"==e&&($(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>You ran out of time!</p>"),g.play())}function N(){$(".correctParty").fadeTo(500,1),$(".correctParty").html("<p>Correct!</p>"),C.play()}function U(e){"labourChoice"==e&&n++,"conservativeChoice"==e&&s++,"libdemChoice"==e&&u++,"ukipChoice"==e&&p++}function D(e,o,i){"agreeChoice"==e&&(o==i?($(".loadingBar").removeClass("loadingBarAnimate"),v++,h++,U(o),N()):($(".loadingBar").removeClass("loadingBarAnimate"),L(o,i),U(o),v--)),"disagreeChoice"==e&&(o==i?($(".loadingBar").removeClass("loadingBarAnimate"),L(o,i),v--):($(".loadingBar").removeClass("loadingBarAnimate"),v++,N()))}var B=w.target.id,P="";"labourVote"==B&&"1"==e?(B="The Labour Party",P="labourChoice",imageShow="labourSelectedImage",choiceClassQuestionSection="labourQuestionSection",b(B,P,imageShow,choiceClassQuestionSection)):"conservativeVote"==B&&"1"==e?(B="The Conservative Party",P="conservativeChoice",imageShow="conservativeSelectedImage",choiceClassQuestionSection="conservativeQuestionSection",b(B,P,imageShow,choiceClassQuestionSection)):"libdemVote"==B&&"1"==e?(B="The Liberal Democrats",P="libdemChoice",imageShow="libdemSelectedImage",choiceClassQuestionSection="libdemQuestionSection",b(B,P,imageShow,choiceClassQuestionSection)):"ukipVote"==B&&"1"==e?(B="The United Kingdom Independence Party",P="ukipChoice",imageShow="ukipSelectedImage",choiceClassQuestionSection="ukipQuestionSection",b(B,P,imageShow,choiceClassQuestionSection)):"noVote"==B&&"1"==e&&(B="No preference",P="noChoice",imageShow="novoteSelectedImage",choiceClassQuestionSection="novoteQuestionSection",b(B,P,imageShow,choiceClassQuestionSection)),$("#selectedSection").slideDown("slow"),$("html,body").animate({scrollTop:$("#selectedSection").offset().top},"xslow"),T(),x(),$(".choiceBtn").click(function(){$(".choiceBtn").prop("disabled",!0);var o=this.id;D(o,a,P),q()})})});
